/*! daiad-charts 2016-09-23 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=a("moment"),e=a("./charts");a("./model");e.b1=function(){var a=$.extend({},e.plotOptions);a.defaults.colors=["#2D3580"],a.defaults.colormap=new Map([["default","#2D3580"],["measured-data","#2D3580"],["estimated-data","#AAAEB1"]]);var b=e.formatLabel;return{plotForEvent:function(c,d,f){if(!d||0==d.length)return null;var g=d[0].constructor,h=g.getRange(d),i=h[0],j=h[1],k=j-i,l=d[0].id,m=d[d.length-1].id,n=[l,m];f=$.extend({bars:!0,xaxis:{},yaxis:{},barWidth:.5},f||{}),f.xaxis.ticks||(f.xaxis.ticks=Math.min(10,d.length));var o={series:{points:{show:!1,radius:1},shadowSize:0,lines:f.bars?{show:!1}:$.extend({show:!0},a.defaults.series.lines,{fill:.4}),bars:f.bars?$.extend({show:!0},a.defaults.series.bars,{barWidth:f.barWidth}):{show:!1}},xaxis:$.extend({},a.defaults.xaxis,{ticks:e.generateTicks(n,f.xaxis.ticks,null,function(a){return a.toFixed(0)},f.bars?.5*f.barWidth:0).filter(function(a){return a[0]<m+1}),tickLength:6,min:l-0,max:m+1}),yaxis:$.extend({},a.defaults.yaxis,{ticks:e.generateTicks(h,4,f.yaxis.tickUnit),min:i-0*k,max:j+.1*k}),grid:a.defaults.grid,legend:{show:!1}};return $.plot(c,[{data:$.map(d,function(a){return a.value?[[a.id,a.value]]:null}),label:b(g),color:a.defaults.colors[0]}],o)},plotForTimedEvent:function(c,f,g){if(!f||0==f.length)return null;var h=f[0].constructor,i=h.getRange(f),j=i[0],k=i[1],l=k-j,m=f[0].timestamp.getTime(),n=f[f.length-1].timestamp.getTime(),o=n-m,p=m-Math.floor(.15*o),q=n+Math.floor(.15*o),r=[p,q];g=$.extend({bars:{},xaxis:{},yaxis:{}},g||{});var s={series:{points:{show:!1,radius:1},shadowSize:0,lines:$.extend({show:!0},a.defaults.series.lines,{fill:.4})},xaxis:$.extend({},a.defaults.xaxis,{ticks:e.generateTicks(r,g.xaxis.ticks||5,3e5,function(a){return d(a).format("hh:mm a")}),tickLength:6,min:p,max:q}),yaxis:$.extend({},a.defaults.yaxis,{ticks:e.generateTicks(i,4,g.yaxis.tickUnit),min:j-0*l,max:k+.1*l}),grid:a.defaults.grid,legend:{show:!1}};return $.plot(c,[{data:$.map(f,function(a){return a.value?[[a.timestamp.getTime(),a.value]]:null}),label:b(h),color:a.defaults.colors[0]}],s)},plotForDay:function(a,b,c){},plotForWeek:function(c,f,g,h){var i=f&&f.length?f.length:0,j=g&&g.length?g.length:0;if(!(i>0||j>0))return null;var k=i>0?f[0].constructor:null,l=j>0?g[0].constructor:null,m=k.getRange(f),n=l.getRange(g),o=Math.min(m[0],n[0]),p=Math.max(m[1],n[1]),q=[o,p],r=p-o,s=Math.max(i,j);h=$.extend({bars:{},xaxis:{},yaxis:{}},h||{});var t=(h.resolution||1,h.bars.widthRatio||.6),u={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:$.extend({show:!0},a.defaults.series.bars)},xaxis:$.extend({},a.defaults.xaxis,{ticks:$.map(f,function(a,b){var c=a.timestamp.getTime(),e=h.locale?d(c).locale(h.locale):d(c);return[[a.id+t/2,e.format("dd")]]}),min:0,max:s}),yaxis:$.extend({},a.defaults.yaxis,{ticks:e.generateTicks(q,4,h.yaxis.tickUnit),min:o-0*r,max:p+.1*r}),grid:a.defaults.grid,legend:{show:!1,position:"ne"},bars:$.extend({},a.defaults.bars,{barWidth:t})},v=[];if(i>0){var w=$.map(f,function(a,b){return[[b,a.value]]});v.push({data:w,label:b(k),color:a.defaults.colormap.get("measured-data")})}if(j>0)for(var x=0;j>x;)if(null!=g[x].value){for(var y=x+1,z=null;i>y&&null==f[y].value;)y++;z=y==i?j-x:y-x,v.push({data:[[x,g[x].value]],label:b(l),color:a.defaults.colormap.get("estimated-data"),bars:{barWidth:t+z-1}}),x=y}else x++;return $.plot(c,v,u)},plotForMonth:function(c,d,f){if(!d||0==d.length)return null;var g=d[0].constructor,h=g.getRange(d),i=h[0],j=h[1],k=j-i;f=$.extend({bars:{},xaxis:{},yaxis:{}},f||{});var l=f.resolution||1,m={series:{points:$.extend({show:!0},a.defaults.series.points),shadowSize:0,lines:$.extend({show:!0},a.defaults.series.lines,{fill:.4})},xaxis:$.extend({},a.defaults.xaxis,{ticks:$.map(new Array(e.WEEKS_IN_MONTH-1),function(a,b){var c=7*(b+1)/l;return[[c,(f.weekLabel||"week")+" "+(b+1).toString()]]}),min:0,max:d.length}),yaxis:$.extend({},a.defaults.yaxis,{ticks:e.generateTicks(h,4,f.yaxis.tickUnit),min:i-0*k,max:j+.1*k}),grid:a.defaults.grid,legend:{show:!1}};return $.plot(c,[{data:$.map(d,function(a){return a.value?[[a.id,a.value]]:null}),label:b(g),color:a.defaults.colors[0]}],m)},plotForYear:function(c,f,g){if(!f||0==f.length)return null;var h=f[0].constructor,i=h.getRange(f),j=i[0],k=i[1],l=k-j;g=$.extend({bars:{},xaxis:{},yaxis:{}},g||{});var m=g.resolution||1,n=d.monthsShort(),o={series:{points:$.extend({show:!0},a.defaults.series.points),shadowSize:0,lines:$.extend({show:!0},a.defaults.series.lines,{fill:.4})},xaxis:$.extend({},a.defaults.xaxis,{ticks:$.map(f,function(a,b){return[[a.id,n[b*m]]]}),min:0,max:f.length}),yaxis:$.extend({},a.defaults.yaxis,{ticks:e.generateTicks(i,4,g.yaxis.tickUnit),min:j-0*l,max:k+.1*l}),grid:a.defaults.grid,legend:{show:!1}};return $.plot(c,[{data:$.map(f,function(a){return a.value?[[a.id,a.value]]:null}),label:b(h),color:a.defaults.colors[0]}],o)}}}(),b.exports=e.b1},{"./charts":2,"./model":7,moment:"moment"}],2:[function(a,b,c){"use strict";var d=a("./index");d.charts||(d.charts={}),$.extend(d.charts,{WEEKS_IN_MONTH:5,plotOptions:{defaults:{series:{points:{radius:2},shadowSize:0,lines:{lineWidth:1},bars:{lineWidth:1,fill:.8}},bars:{align:"left",horizontal:!1},xaxis:{tickLength:0,tickColor:"#bbb"},yaxis:{tickLength:0,tickColor:"#bbb"},grid:{color:"#bbb",backgroundColor:null,margin:{top:15,bottom:10,left:20,right:10},borderWidth:{top:0,right:0,bottom:0,left:0}}}},formatLabel:function(a,b){var c=a.value.title+" ("+a.value.unit+")";return b&&b.description&&(c+=" ("+b.description+")"),c},filterForData:function(a){var b=a.range[0],c=a.range[1];return function(a){return null!=a.value&&a.value>=b&&a.value<c?[[a.id,a.value]]:null}},getDefaultLevel:function(a,b,c){return{range:[a,b+1],color:c}},generateTicks:function(a,b,c,d,e){var f,g,h,i=a[1]-a[0];if(!c){var j=Math.floor(Math.log10(Math.abs(a[1])));if(c=Math.pow(10,j),i>0)for(;i<(b-2)*Math.ceil(i/(b*c))*c;)c=.1*c}return console.debug("generateTicks: Using m="+c),i>0?(f=Math.ceil(i/(b*c))*c,g=Math.floor(a[0]/c)*c,h=a[1]-g<b*f?b+1:b+2):(f=Math.max(Math.floor(.2*a[0]/c),1)*c,g=Math.floor(a[0]/c)*c,h=2),d||(d=function(a,b,c){var d=Number.isInteger(a)?0:1;return a.toFixed(d)}),e=null==e?0:Number(e),$.map(new Array(h),function(a,b){var c=g+b*f;return[[c+e,d.call(null,c,b,f)]]})}}),b.exports=d.charts},{"./index":4}],3:[function(a,b,c){"use strict";var d=a("./charts");d.comparison=function(){var a=$.extend({},d.plotOptions);a.defaults.colors=["#2D3580"],a.defaults.grid.margin={top:15,bottom:10,left:25,right:25};var b=d.generateTicks;return{plotBarsWithLabels:function(b,c,d){var e=8,f=8,g=function(a){return a[1]},h=Math.min.apply(null,$.map(c,g)),i=Math.max.apply(null,$.map(c,g)),j=i-h;d=$.extend({points:{},labels:{},bars:{}},d||{}),d.labels=$.extend({paddingX:f,marginX:e,align:"right"},d.labels),d.bars=$.extend({widthRatio:.85},d.bars);var k={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:{show:!0,lineWidth:1,fill:.9}},xaxis:{ticks:[],max:i+.4*j},yaxis:{ticks:[]},grid:a.defaults.grid,legend:{show:!1},bars:{barWidth:d.bars.widthRatio,align:"right",horizontal:!0}},l=$.map(c,function(a,b){var c=a[0],e=a[1],f=d.points.get(c);return{data:[[e,b]],color:f.color,label:f.label}}),m=$.plot(b,l,k);return $.each(c,function(a,c){var e=c[0],f=c[1],g=d.points.get(e),h=m.pointOffset({x:0,y:a}),i=m.pointOffset({x:f,y:a}),j=m.pointOffset({x:f,y:a-1*d.bars.widthRatio}),k={top:i.top.toString()+"px",left:i.left.toString()+"px",height:(j.top-i.top).toString()+"px","line-height":(j.top-i.top-4).toString()+"px","padding-left":d.labels.paddingX.toString()+"px","padding-right":d.labels.paddingX.toString()+"px"};$("<div>").addClass("value-label").addClass("value").text(f.toFixed(0)).css(k).appendTo(b),$("<div>").addClass("value-label").addClass("label").text(g.label).css($.extend({},k,{width:(i.left-h.left-2*(d.labels.marginX+d.labels.paddingX)).toString()+"px",left:(h.left+d.labels.marginX).toString()+"px","text-align":d.labels.align,color:g.labelColor})).appendTo(b)}),m},plotBarsWithMarkers:function(b,c,d){var e=1.8,f=2.3,g=.6,h=parseFloat(b.css("font-size")),i=2,j=(e+g/Math.SQRT2)*h+i,k=f*h;d=$.extend({range:[1,10],points:{},bars:{},numSteps:10},d||{}),d.bars=$.extend({color:"#BBB",widthRatio:.25},d.bars),d.bars.widthRatio=Math.min(d.bars.widthRatio,.5);var l=d.range[0],m=d.range[1],n=d.numSteps,o=m-l,p=o/(n-1),q=function(a){return l+p*(a-1)},r=function(a){return 1+(a-l)/p},s=function(a,b,c){var d=a.pointOffset({x:b[0],y:b[1]});return c||(c=0),$("<div>").addClass("value-marker").css({top:d.top-c-j,left:d.left-k/2})},t=$.map(c,function(a,b){var c=a[1],d=null;return d=c>m||l>c?null:Math.round(r(c)),{x:d,y:d?q(d):null,key:a[0]}}),u={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:{show:!0,lineWidth:1,fill:1}},xaxis:{ticks:[]},yaxis:{ticks:[],min:l-.05*o,max:m+.4*o},grid:a.defaults.grid,legend:{show:!1},bars:{barWidth:d.bars.widthRatio,align:"center",horizontal:!1}},v=[{data:$.map(new Array(n),function(a,b){return[[b+1,q(b+1)]]}),color:d.bars.color}];v.push.apply(v,$.map(t,function(a,b){var c=d.points.get(a.key)||{};return{data:[[a.x,a.y]],color:c.color,bars:{barWidth:1.4*d.bars.widthRatio}}}));var w=$.plot(b,v,u),x=new Array(n).fill(0);return $.each(t,function(a,b){if(null!=b.x){var c=d.points.get(b.key)||{},e=x[b.x]*j;x[b.x]++;var f=s(w,[b.x,b.y],e).text(c.label||b.key).css({color:c.labelColor,"background-color":c.color,"border-color":c.color});w.getPlaceholder().append(f)}}),w},plotBarsAsPairs:function(c,d,e,f){var g=function(a,b){return a[0].localeCompare(b[0])},h=function(a){return a[0]},i=null;d.sort(g),e.sort(g),i=$.map(d,h);var j=function(a){return a[1]},k=Math.min.apply(null,$.map(d,j)),l=Math.max.apply(null,$.map(d,j)),m=Math.min.apply(null,$.map(e,j)),n=Math.max.apply(null,$.map(e,j)),o=Math.min(k,m),p=Math.max(l,n),q=p-o;f=$.extend({range:null,meta:[{label:"A"},{label:"B"}],points:null,legend:"default",yaxis:{},bars:{}},f||{}),f.range||(f.range=[o,p]),f.bars=$.extend({widthRatio:.85},f.bars);var r={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:{show:!0,lineWidth:1,fill:1}},xaxis:{ticks:f.points instanceof Map?$.map(i,function(a,b){var c=f.points.get(a)||{};return[[b+0,(c.label||a).toString()]]}):[],tickLength:0,tickColor:a.defaults.xaxis.tickColor,min:null,max:null},yaxis:{ticks:b([o,p],5,f.yaxis.tickUnit),tickLength:0,tickColor:a.defaults.yaxis.tickColor,min:o-.05*q,max:p+.4*q},grid:a.defaults.grid,legend:{show:!1},bars:{barWidth:f.bars.widthRatio,horizontal:!1,fill:.95}};"default"==f.legend&&(r.legend={show:!0,position:"ne",backgroundOpacity:0,noColumns:2,margin:5});var s=$.map([d,e],function(a,b){return{data:$.map(a,function(a,b){return[[b,a[1]]]}),color:f.meta[b].labelColor,label:f.meta[b].label,bars:{align:0==b?"right":"left"}}}),t=$.plot(c,s,r);switch(f.legend){case"center":case"centre":var u=16,v=parseFloat(c.css("font-size")),w=u*v,x=$("<div>").addClass("legend-centered").css({width:w,top:8,left:(c.width()-w)/2});x.appendTo(c),$.each(t.getData(),function(a,b){x.append($("<div>").addClass("color-box").text(b.label).css({backgroundColor:b.color}))});break;case"default":}return t}}}()},{"./charts":2}],4:[function(a,b,c){"use strict";b.exports={VERSION:"0.1dev"}},{}],5:[function(a,b,c){(function(c){"use strict";var d=a("./index");a("./model"),a("./meter-charts"),a("./b1-charts"),a("./comparison-charts"),b.exports=d,c.daiad=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./b1-charts":1,"./comparison-charts":3,"./index":4,"./meter-charts":6,"./model":7}],6:[function(a,b,c){"use strict";var d=a("moment"),e=a("./charts");a("./model");e.meter=function(){function a(a,c){return e.getDefaultLevel(a,c,b.defaults.colors[0])}var b=$.extend({},e.plotOptions);b.defaults.colors=["#2D3580"];var c=e.formatLabel,f=e.filterForData;return{plotForDay:function(g,h,i){if(!h||0==h.length)return null;var j=h[0].constructor,k=j.getRange(h),l=k[0],m=k[1],n=m-l;i=$.extend({bars:{},xaxis:{},yaxis:{}},i||{});var o=(i.resolution||1,i.bars.widthRatio||.6),p=i.xaxis.tickSize||4,q={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:$.extend({show:!0},b.defaults.series.bars)},xaxis:$.extend({},b.defaults.xaxis,{ticks:$.map(h,function(a,b){var c=a.timestamp.getTime(),e=i.locale?d(c).locale(i.locale):d(c);return b%p==0?[[a.id+o/2,e.format("ha")]]:null}),min:0,max:h.length}),yaxis:$.extend({},b.defaults.yaxis,{ticks:e.generateTicks(k,4,i.yaxis.tickUnit),min:l-0*n,max:m+.1*n}),grid:b.defaults.grid,legend:{show:!1,position:"ne"},bars:$.extend({},b.defaults.bars,{barWidth:o})},r=i.levels||[a(l,m)],s=$.map(r,function(a,b){return{data:$.map(h,f(a)),label:c(j,a),color:a.color}});return $.plot(g,s,q)},plotForWeek:function(g,h,i){if(!h||0==h.length)return null;var j=h[0].constructor,k=j.getRange(h),l=k[0],m=k[1],n=m-l;i=$.extend({bars:{},xaxis:{},yaxis:{}},i||{});var o=(i.resolution||1,i.bars.widthRatio||.6),p={series:{points:{show:!1},shadowSize:0,lines:{show:!1},bars:$.extend({show:!0},b.defaults.series.bars)},xaxis:$.extend({},b.defaults.xaxis,{ticks:$.map(h,function(a,b){var c=a.timestamp.getTime(),e=i.locale?d(c).locale(i.locale):d(c);return[[a.id+o/2,e.format("dd")]]}),min:0,max:h.length}),yaxis:$.extend({},b.defaults.yaxis,{ticks:e.generateTicks(k,4,i.yaxis.tickUnit),min:l-0*n,max:m+.1*n}),grid:b.defaults.grid,legend:{show:!1,position:"ne"},bars:$.extend({},b.defaults.bars,{barWidth:o})},q=i.levels||[a(l,m)],r=$.map(q,function(a,b){return{data:$.map(h,f(a)),label:c(j,a),color:a.color}});return $.plot(g,r,p)},plotForMonth:function(a,d,f){if(!d||0==d.length)return null;var g=d[0].constructor,h=g.getRange(d),i=h[0],j=h[1],k=j-i;f=$.extend({bars:{},xaxis:{},yaxis:{}},f||{});var l=f.resolution||1,m={series:{points:$.extend({show:!0},b.defaults.series.points),shadowSize:0,lines:$.extend({show:!0},b.defaults.series.lines,{fill:.4})},xaxis:$.extend({},b.defaults.xaxis,{ticks:$.map(new Array(e.WEEKS_IN_MONTH-1),function(a,b){var c=7*(b+1)/l;return[[c,(f.weekLabel||"week")+" "+(b+1).toString()]]}),min:0,max:d.length}),yaxis:$.extend({},b.defaults.yaxis,{ticks:e.generateTicks(h,4,f.yaxis.tickUnit),min:i-0*k,max:j+.1*k}),grid:b.defaults.grid,legend:{show:!1}};return $.plot(a,[{data:$.map(d,function(a){return a.value?[[a.id,a.value]]:null}),label:c(g),color:b.defaults.colors[0]}],m)},plotForYear:function(a,f,g){if(!f||0==f.length)return null;var h=f[0].constructor,i=h.getRange(f),j=i[0],k=i[1],l=k-j;g=$.extend({bars:{},xaxis:{},yaxis:{}},g||{});var m=g.resolution||1,n=d.monthsShort(),o={series:{points:$.extend({show:!0},b.defaults.series.points),shadowSize:0,lines:$.extend({show:!0},b.defaults.series.lines,{fill:.4})},xaxis:$.extend({},b.defaults.xaxis,{ticks:$.map(f,function(a,b){return[[a.id,n[b*m]]]}),min:0,max:f.length}),yaxis:$.extend({},b.defaults.yaxis,{ticks:e.generateTicks(i,4,g.yaxis.tickUnit),min:j-0*l,max:k+.1*l}),grid:b.defaults.grid,legend:{show:!1}};return $.plot(a,[{data:$.map(f,function(a){return a.value?[[a.id,a.value]]:null}),label:c(h),color:b.defaults.colors[0]}],o)}}}(),b.exports=e.meter},{"./charts":2,"./model":7,moment:"moment"}],7:[function(a,b,c){"use strict";var d=a("./index");d.model||(d.model={}),$.extend(d.model,function(){function a(a,b,c){if(!(b instanceof Date))throw new Error("Expected a instance of Date as timestamp");return this.id=parseInt(a),this.timestamp=b,this.value=null==c?null:parseFloat(c),this}function b(b,c,d){return a.call(this,b,c,d),this}a.prototype.getValue=function(a){return this.value.toFixed(a||2)+" ("+this.constructor.value.unit.toString()+")"};var c=function(a){return a.value};return $.extend(a,{timestamp:{name:"timestamp",title:"Time",unit:"milliseconds"},value:{name:"value",title:"Value",unit:null},computeRange:function(a){if(!(a&&a.length>0))return[-(1/0),+(1/0)];var b=Math.min.apply(null,$.map(a,c)),d=Math.max.apply(null,$.map(a,c));return[b,d]},computePositiveRange:function(a){if(!(a&&a.length>0))return[0,+(1/0)];var b=Math.max.apply(null,$.map(a,c));return b>0||console.warn("Expected positive maximum value ("+b+")"),[0,b]}}),a.getRange=a.computePositiveRange,$.extend(b.prototype,a.prototype,{}),$.extend(b,a,{value:{name:"value",title:"Energy",unit:"kW"}}),{Measurement:a,EnergyMeasurement:b}}()),b.exports=d.model},{"./index":4}]},{},[5]);